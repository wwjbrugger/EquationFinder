# NeuralGuidedEquationDiscovery

### create_random_dataset

` python src/generate_datasets/create_random_dataset.py --save_folder data --number_equations 1000 --seed 42 --max_depth_of_tree 6 --num_calls_sampling 20 --how_to_select_node_to_delete 0 --sample_with_noise False  --logging_level 30 --max_branching_factor 2 --store_multiple_versions_of_one_equation True --max_constants_in_tree 0 `

### contrastive loss 
` python src/start_nged.py --experiment_name TextTransformer --seed 60 --minutes_to_run 60 --logging_level 20 --wandb disabled --gpu 1 --data data/run_1 --num_selfplay_iterations 5 --num_selfplay_iterations_test 5 --test_network False --test_every_n_steps 5 --precision float32 --minimum_reward -1 --maximum_reward 1 --max_depth_of_tree 6 --max_branching_factor 2 --max_constants_in_tree 2 --batch_size_loading 1 --batch_size_training 16 --num_gradient_steps 20 --average_policy_if_wrong False --cold_start_iterations 20 --equation_preprocess_class PandasPreprocess --max_len_datasets 100 --class_equation_encoder Transformer_Encoder_String --embedding_dim_encoder_equation 8 --tree_representation tree_structure --max_tokens_equation 64 --use_position_encoding False --num_layer_encoder_equation_transformer 2 --num_heads_encoder_equation_transformer 4 --dim_feed_forward_equation_encoder_transformer 32 --dropout_rate 0.1 --observation_length 1 --class_measurement_encoder TextTransformer --normalize_approach abs_max_y --contrastive_loss True --encoder_measurements_LSTM_units 64 --encoder_measurements_LSTM_return_sequence True --encoder_measurement_num_layer 3 --encoder_measurement_num_neurons 64 --model_dim_hidden_dataset_transformer 64 --model_num_heads_dataset_transformer 8 --model_stacking_depth_dataset_transformer 4 --model_sep_res_embed_dataset_transformer True --model_att_block_layer_norm_dataset_transformer True --model_layer_norm_eps_dataset_transformer 1e-12 --model_att_score_norm_dataset_transformer softmax --model_pre_layer_norm_dataset_transformer False --model_rff_depth_dataset_transformer 2 --model_hidden_dropout_prob_dataset_transformer 1e-06 --model_att_score_dropout_prob_dataset_transformer 1e-06 --model_mix_heads_dataset_transformer True --model_embedding_layer_norm_dataset_transformer False --bit_embedding_dataset_transformer False --use_latent_vector_dataset_transformer_dataset_transformer True --actor_decoder_class mlp_decoder --actor_decoder_normalize_way positive_sum_1 --critic_decoder_class mlp_decoder --critic_decoder_normalize_way tanh --MCTS_engine Normal --max_elements_in_list 10 --prior_source neural_net --temp_0 0.1 --temperature_decay -0.01 --dirichlet_alpha 0.3 --num_MCTS_sims 50 --c1 1.25 --c2 19652 --gamma 0.98 --n_steps 100 --risk_seeking False --depth_first_search True --prioritize False --prioritize_alpha 0.5 --prioritize_beta 1 --selfplay_buffer_window 50 --max_buffer_size 200_000 --balance_buffer False --max_percent_of_minimal_reward_runs_in_buffer 0.3 --path_to_pretrained_dataset_encoder None --use-puct False --float_precision_text_transformer 3 --mantissa_len_text_transformer 1 --max_exponent_text_transformer 100 --num_dimensions_text_transformer 3 --embedding_dim_text_transformer 512 --embedder_intermediate_expansion_factor_text_transformer 1.0 --num_encoder_layers_text_transformer 4 --num_attention_heads_text_transformer 8 --encoder_intermediate_expansion_factor_text_transformer 4.0 --intermediate_dropout_rate_text_transformer 0.2 --attention_dropout_rate_text_transformer 0.1 `
